"""
IKEv2 Constants from RFC 7296
"""

from enum import IntEnum

IKE_PORT = 500
IKE_NAT_PORT = 4500
IKE_VERSION = 0x20
IKE_HEADER_SIZE = 28
MAX_SPI_SIZE = 8

class ExchangeType(IntEnum):
    IKE_SA_INIT = 34
    IKE_AUTH = 35
    CREATE_CHILD_SA = 36
    INFORMATIONAL = 37

class PayloadType(IntEnum):
    NO_NEXT_PAYLOAD = 0
    SA = 33
    KE = 34
    IDI = 35
    IDR = 36
    CERT = 37
    CERTREQ = 38
    AUTH = 39
    NONCE = 40
    NOTIFY = 41
    DELETE = 42
    VENDOR = 43
    TSI = 44
    TSR = 45
    SK = 46
    CP = 47
    EAP = 48

class ProtocolID(IntEnum):
    IKE = 1
    AH = 2
    ESP = 3

class TransformType(IntEnum):
    ENCR = 1
    PRF = 2
    INTEG = 3
    DH = 4
    ESN = 5

class TransformID:
    class ENCR(IntEnum):
        DES_IV64 = 1
        DES = 2
        THREE_DES = 3
        RC5 = 4
        IDEA = 5
        CAST = 6
        BLOWFISH = 7
        THREE_IDEA = 8
        DES_IV32 = 9
        NULL = 11
        AES_CBC = 12
        AES_CTR = 13
        AES_CCM_8 = 14
        AES_CCM_12 = 15
        AES_CCM_16 = 16
        AES_GCM_8 = 18
        AES_GCM_12 = 19
        AES_GCM_16 = 20
        CAMELLIA_CBC = 23
        CAMELLIA_CTR = 24
        CAMELLIA_CCM_8 = 25
        CAMELLIA_CCM_12 = 26
        CAMELLIA_CCM_16 = 27
        CHACHA20_POLY1305 = 28
    
    class PRF(IntEnum):
        HMAC_MD5 = 1
        HMAC_SHA1 = 2
        HMAC_TIGER = 3
        AES128_XCBC = 4
        HMAC_SHA256 = 5
        HMAC_SHA384 = 6
        HMAC_SHA512 = 7
        AES128_CMAC = 8
    
    class INTEG(IntEnum):
        NONE = 0
        AUTH_HMAC_MD5_96 = 1
        AUTH_HMAC_SHA1_96 = 2
        AUTH_DES_MAC = 3
        AUTH_KPDK_MD5 = 4
        AUTH_AES_XCBC_96 = 5
        AUTH_HMAC_MD5_128 = 6
        AUTH_HMAC_SHA1_160 = 7
        AUTH_AES_CMAC_96 = 8
        AUTH_AES_128_GMAC = 9
        AUTH_AES_192_GMAC = 10
        AUTH_AES_256_GMAC = 11
        AUTH_HMAC_SHA256_128 = 12
        AUTH_HMAC_SHA384_192 = 13
        AUTH_HMAC_SHA512_256 = 14
    
    class DH(IntEnum):
        NONE = 0
        MODP_768 = 1
        MODP_1024 = 2
        MODP_1536 = 5
        MODP_2048 = 14
        MODP_3072 = 15
        MODP_4096 = 16
        MODP_6144 = 17
        MODP_8192 = 18
        ECP_256 = 19
        ECP_384 = 20
        ECP_521 = 21
        MODP_1024_160 = 22
        MODP_2048_224 = 23
        MODP_2048_256 = 24
        ECP_192 = 25
        ECP_224 = 26
        BRAINPOOL_P224R1 = 27
        BRAINPOOL_P256R1 = 28
        BRAINPOOL_P384R1 = 29
        BRAINPOOL_P512R1 = 30
        CURVE25519 = 31
        CURVE448 = 32
    
    class ESN(IntEnum):
        NO_ESN = 0
        ESN = 1

class AuthMethod(IntEnum):
    RSA_DIGITAL_SIGNATURE = 1
    SHARED_KEY = 2
    DSS_DIGITAL_SIGNATURE = 3
    ECDSA_SHA256_P256 = 9
    ECDSA_SHA384_P384 = 10
    ECDSA_SHA512_P521 = 11
    GENERIC_DIGITAL_SIGNATURE = 14

class NotifyType(IntEnum):
    UNSUPPORTED_CRITICAL_PAYLOAD = 1
    INVALID_IKE_SPI = 4
    INVALID_MAJOR_VERSION = 5
    INVALID_SYNTAX = 7
    INVALID_MESSAGE_ID = 9
    INVALID_SPI = 11
    NO_PROPOSAL_CHOSEN = 14
    INVALID_KE_PAYLOAD = 17
    AUTHENTICATION_FAILED = 24
    SINGLE_PAIR_REQUIRED = 34
    NO_ADDITIONAL_SAS = 35
    INTERNAL_ADDRESS_FAILURE = 36
    FAILED_CP_REQUIRED = 37
    TS_UNACCEPTABLE = 38
    INVALID_SELECTORS = 39
    TEMPORARY_FAILURE = 43
    CHILD_SA_NOT_FOUND = 44
    
    INITIAL_CONTACT = 16384
    SET_WINDOW_SIZE = 16385
    ADDITIONAL_TS_POSSIBLE = 16386
    IPCOMP_SUPPORTED = 16387
    NAT_DETECTION_SOURCE_IP = 16388
    NAT_DETECTION_DESTINATION_IP = 16389
    COOKIE = 16390
    USE_TRANSPORT_MODE = 16391
    HTTP_CERT_LOOKUP_SUPPORTED = 16392
    REKEY_SA = 16393
    ESP_TFC_PADDING_NOT_SUPPORTED = 16394
    NON_FIRST_FRAGMENTS_ALSO = 16395
    MOBIKE_SUPPORTED = 16396
    ADDITIONAL_IP4_ADDRESS = 16397
    ADDITIONAL_IP6_ADDRESS = 16398
    NO_ADDITIONAL_ADDRESSES = 16399
    UPDATE_SA_ADDRESSES = 16400
    COOKIE2 = 16401
    NO_NATS_ALLOWED = 16402
    AUTH_LIFETIME = 16403
    MULTIPLE_AUTH_SUPPORTED = 16404
    ANOTHER_AUTH_FOLLOWS = 16405
    REDIRECT_SUPPORTED = 16406
    REDIRECT = 16407
    REDIRECTED_FROM = 16408
    TICKET_LT_OPAQUE = 16409
    TICKET_REQUEST = 16410
    TICKET_ACK = 16411
    TICKET_NACK = 16412
    TICKET_OPAQUE = 16413
    LINK_ID = 16414
    USE_WESP_MODE = 16415
    ROHC_SUPPORTED = 16416
    EAP_ONLY_AUTHENTICATION = 16417
    CHILDLESS_IKEV2_SUPPORTED = 16418
    QUICK_CRASH_DETECTION = 16419
    IKEV2_MESSAGE_ID_SYNC_SUPPORTED = 16420
    IPSEC_REPLAY_COUNTER_SYNC_SUPPORTED = 16421
    IKEV2_MESSAGE_ID_SYNC = 16422
    IPSEC_REPLAY_COUNTER_SYNC = 16423
    SECURE_PASSWORD_METHODS = 16424
    PSK_PERSIST = 16425
    PSK_CONFIRM = 16426
    ERX_SUPPORTED = 16427
    IFOM_CAPABILITY = 16428
    SENDER_REQUEST_ID = 16429
    IKEV2_FRAGMENTATION_SUPPORTED = 16430
    SIGNATURE_HASH_ALGORITHMS = 16431

class CertificateEncoding(IntEnum):
    PKCS7_X509_CERT = 1
    PGP_CERT = 2
    DNS_SIGNED_KEY = 3
    X509_CERT_SIGNATURE = 4
    KERBEROS_TOKEN = 6
    CRL = 7
    ARL = 8
    SPKI = 9
    X509_CERT_ATTR = 10
    RAW_RSA_KEY = 11
    HASH_URL_X509_CERT = 12
    HASH_URL_X509_BUNDLE = 13

class IDType(IntEnum):
    IPV4_ADDR = 1
    FQDN = 2
    RFC822_ADDR = 3
    IPV6_ADDR = 5
    DER_ASN1_DN = 9
    DER_ASN1_GN = 10
    KEY_ID = 11

class TSType(IntEnum):
    IPV4_ADDR_RANGE = 7
    IPV6_ADDR_RANGE = 8

class ConfigType(IntEnum):
    CFG_REQUEST = 1
    CFG_REPLY = 2
    CFG_SET = 3
    CFG_ACK = 4

class ConfigAttribute(IntEnum):
    INTERNAL_IP4_ADDRESS = 1
    INTERNAL_IP4_NETMASK = 2
    INTERNAL_IP4_DNS = 3
    INTERNAL_IP4_NBNS = 4
    INTERNAL_IP4_DHCP = 6
    APPLICATION_VERSION = 7
    INTERNAL_IP6_ADDRESS = 8
    INTERNAL_IP6_DNS = 10
    INTERNAL_IP6_DHCP = 12
    INTERNAL_IP4_SUBNET = 13
    SUPPORTED_ATTRIBUTES = 14
    INTERNAL_IP6_SUBNET = 15

FLAGS_INITIATOR = 0x08
FLAGS_VERSION = 0x10
FLAGS_RESPONSE = 0x20

COOKIE_SIZE = 64
COOKIE_THRESHOLD = 10

MAX_FRAGMENT_SIZE = 1280
MIN_FRAGMENT_SIZE = 64

IKE_SA_INIT_RETRANSMIT = [1, 2, 4, 8, 16, 32, 64]
IKE_AUTH_RETRANSMIT = [1, 2, 4, 8, 16, 32]